<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script>
        function handleOptionSelection() {
            var selectedOption = $("#clothesSelect").val();
            var formAction = "catalog";
            formAction += "?category=" + selectedOption;
            $("#searchForm").attr("action", formAction).submit();
        }
    </script>

</head>
<style>



   summary::-webkit-details marker{
            display: none;
        }
         html{
             background-color: #800080;
         }

    summary {
        height: 30px;
        width: 98%;
        position: relative;
        left: 1%;
        border: 1px solid #333;
        margin: 10px;
        text-align: center;
        line-height: 30px;
        border-radius: 10px;
        background-color: white;
    }
</style>



<body>

    <datails>
        <summary>PER ASPERA AD ASTRA</summary>


    </datails>

    <body>

        <form action="search" method="POST">
        <button onclick="changefont()">Пошук</button>
        <input type="text" name="query">
        </form>

        <form action="catalog" method="POST">
        <button onclick="changefont()">Обрати</button>
        <select name="clothes" id="clothesSelect">
            <option value="Shirt">Сорочка</option>
            <option value="T-Shirt">Футболка</option>
            <option value="Pants">Штани</option>
            <option value="Jacket">Куртка</option>
            <option value="Footwear">Взуття</option>
        </select>
        </form>
        <form action="/filter_price" method="GET" id="filterForm">
            <label for="price">Enter Price:</label>
            <input type="text" id="price" name="name" value="{{ price }}" required>
            <button type="submit">Filter</button>
        </form>

    {% if result %}
        <ul>
            {% for res in result %}
                <li>
                    <strong>Title:</strong> {{ res[1] }} <br>
                    <strong>Color:</strong> {{ res[2] }} <br>
                    <strong>Price:</strong> {{ res[3] }}
                    <form action="/rating" method="POST" id="ratingForm" onsubmit="return rateProduct('{{ res[0] }}')">
                    <input type="hidden" name="product_id" value="{{ res[0] }}">
                    <input type="number" id="rating{{ res[0] }}" name="rating" min="0" max="5" required>
                    <button type="submit">Rate</button>
              </form>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No results found for your query.</p>
    {% endif %}

<form action="/">
    <button type="submit">Go to home page</button>
</form>

<script>
    function rateProduct(productId) {
        var ratingInput = document.getElementById("rating" + productId);
        var rating = ratingInput.value;

        var formData = new FormData();
        formData.append('product_id', productId);
        formData.append('rating', rating);

        fetch('/rating', {
            method: 'POST',
            body: formData,
        })
        .then(response => response.json())
        .then(data => {
            console.log('Product rated:', data);




            alert('Rating updated successfully');


            window.location.reload();
        })
        .catch(error => {
            console.error('Error rating product:', error);


        });


        return false;
    }
</script>

    </body>
    <html />




